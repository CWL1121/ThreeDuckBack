import{_ as Y,r as U,o as j,c as N,w as te,v as ne,b as F,e as se,f as ie,t as oe,p as re,d as ae,g as le,h as ce,i as G,j as O}from"./index.0829e014.js";import{V as E,B as V,L as de,P as he,T as ue,a as S,b as x,C as pe,S as D,c as fe,d as me,Q as ye,e as Z,M as Q,f as K,g as ge,h as J,i as we,j as xe,k as ve,W as Be,A as be,D as Se,l as Ee,m as Pe,R as Ce,n as Me,G as Te,o as _e,p as Le,q as Fe,r as b,s as ze,t as ke,u as He,v as Ie,w as Ae,x as Re,y as Ge,z as Oe}from"./progress.9f4226b3.js";import je from"https://unpkg.com/three@0.122.0/examples/jsm/libs/stats.module.js";import{g as Ne}from"./dialogflowApi.09e3aa41.js";var Ve=function(){var o=0,t=1,s=new E;function i(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new w,this.unassigned=new w,this.vertices=[]}Object.assign(i.prototype,{setFromPoints:function(e){Array.isArray(e)!==!0&&console.error("THREE.ConvexHull: Points parameter is not an array."),e.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var n=0,l=e.length;n<l;n++)this.vertices.push(new m(e[n]));return this.compute(),this},setFromObject:function(e){var n=[];return e.updateMatrixWorld(!0),e.traverse(function(l){var h,r,f,a=l.geometry;if(a!==void 0&&(a.isGeometry&&(a=a.toBufferGeometry?a.toBufferGeometry():new V().fromGeometry(a)),a.isBufferGeometry)){var p=a.attributes.position;if(p!==void 0)for(h=0,r=p.count;h<r;h++)f=new E,f.fromBufferAttribute(p,h).applyMatrix4(l.matrixWorld),n.push(f)}}),this.setFromPoints(n)},containsPoint:function(e){for(var n=this.faces,l=0,h=n.length;l<h;l++){var r=n[l];if(r.distanceToPoint(e)>this.tolerance)return!1}return!0},intersectRay:function(e,n){for(var l=this.faces,h=-1/0,r=1/0,f=0,a=l.length;f<a;f++){var p=l[f],g=p.distanceToPoint(e.origin),d=p.normal.dot(e.direction);if(g>0&&d>=0)return null;var B=d!==0?-g/d:0;if(!(B<=0)&&(d>0?r=Math.min(B,r):h=Math.max(B,h),h>r))return null}return h!==-1/0?e.at(h,n):e.at(r,n),n},intersectsRay:function(e){return this.intersectRay(e,s)!==null},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(e,n){return e.face=n,n.outside===null?this.assigned.append(e):this.assigned.insertBefore(n.outside,e),n.outside=e,this},removeVertexFromFace:function(e,n){return e===n.outside&&(e.next!==null&&e.next.face===n?n.outside=e.next:n.outside=null),this.assigned.remove(e),this},removeAllVerticesFromFace:function(e){if(e.outside!==null){for(var n=e.outside,l=e.outside;l.next!==null&&l.next.face===e;)l=l.next;return this.assigned.removeSubList(n,l),n.prev=l.next=null,e.outside=null,n}},deleteFaceVertices:function(e,n){var l=this.removeAllVerticesFromFace(e);if(l!==void 0)if(n===void 0)this.unassigned.appendChain(l);else{var h=l;do{var r=h.next,f=n.distanceToPoint(h.point);f>this.tolerance?this.addVertexToFace(h,n):this.unassigned.append(h),h=r}while(h!==null)}return this},resolveUnassignedPoints:function(e){if(this.unassigned.isEmpty()===!1){var n=this.unassigned.first();do{for(var l=n.next,h=this.tolerance,r=null,f=0;f<e.length;f++){var a=e[f];if(a.mark===o){var p=a.distanceToPoint(n.point);if(p>h&&(h=p,r=a),h>1e3*this.tolerance)break}}r!==null&&this.addVertexToFace(n,r),n=l}while(n!==null)}return this},computeExtremes:function(){var e=new E,n=new E,l=[],h=[],r,f,a;for(r=0;r<3;r++)l[r]=h[r]=this.vertices[0];for(e.copy(this.vertices[0].point),n.copy(this.vertices[0].point),r=0,f=this.vertices.length;r<f;r++){var p=this.vertices[r],g=p.point;for(a=0;a<3;a++)g.getComponent(a)<e.getComponent(a)&&(e.setComponent(a,g.getComponent(a)),l[a]=p);for(a=0;a<3;a++)g.getComponent(a)>n.getComponent(a)&&(n.setComponent(a,g.getComponent(a)),h[a]=p)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(n.x))+Math.max(Math.abs(e.y),Math.abs(n.y))+Math.max(Math.abs(e.z),Math.abs(n.z))),{min:l,max:h}},computeInitialHull:function(){var e,n,l;return function(){e===void 0&&(e=new de,n=new he,l=new E);var r,f=this.vertices,a=this.computeExtremes(),p=a.min,g=a.max,d,B,T,L,y,z,_,P,C=0,A=0;for(y=0;y<3;y++)P=g[y].point.getComponent(y)-p[y].point.getComponent(y),P>C&&(C=P,A=y);for(d=p[A],B=g[A],C=0,e.set(d.point,B.point),y=0,z=this.vertices.length;y<z;y++)r=f[y],r!==d&&r!==B&&(e.closestPointToPoint(r.point,!0,l),P=l.distanceToSquared(r.point),P>C&&(C=P,T=r));for(C=-1,n.setFromCoplanarPoints(d.point,B.point,T.point),y=0,z=this.vertices.length;y<z;y++)r=f[y],r!==d&&r!==B&&r!==T&&(P=Math.abs(n.distanceToPoint(r.point)),P>C&&(C=P,L=r));var M=[];if(n.distanceToPoint(L.point)<0)for(M.push(c.create(d,B,T),c.create(L,B,d),c.create(L,T,B),c.create(L,d,T)),y=0;y<3;y++)_=(y+1)%3,M[y+1].getEdge(2).setTwin(M[0].getEdge(_)),M[y+1].getEdge(1).setTwin(M[_+1].getEdge(0));else for(M.push(c.create(d,T,B),c.create(L,d,B),c.create(L,B,T),c.create(L,T,d)),y=0;y<3;y++)_=(y+1)%3,M[y+1].getEdge(2).setTwin(M[0].getEdge((3-y)%3)),M[y+1].getEdge(0).setTwin(M[_+1].getEdge(1));for(y=0;y<4;y++)this.faces.push(M[y]);for(y=0,z=f.length;y<z;y++)if(r=f[y],r!==d&&r!==B&&r!==T&&r!==L){C=this.tolerance;var R=null;for(_=0;_<4;_++)P=this.faces[_].distanceToPoint(r.point),P>C&&(C=P,R=this.faces[_]);R!==null&&this.addVertexToFace(r,R)}return this}}(),reindexFaces:function(){for(var e=[],n=0;n<this.faces.length;n++){var l=this.faces[n];l.mark===o&&e.push(l)}return this.faces=e,this},nextVertexToAdd:function(){if(this.assigned.isEmpty()===!1){var e,n=0,l=this.assigned.first().face,h=l.outside;do{var r=l.distanceToPoint(h.point);r>n&&(n=r,e=h),h=h.next}while(h!==null&&h.face===l);return e}},computeHorizon:function(e,n,l,h){this.deleteFaceVertices(l),l.mark=t;var r;n===null?r=n=l.getEdge(0):r=n.next;do{var f=r.twin,a=f.face;a.mark===o&&(a.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,f,a,h):h.push(r)),r=r.next}while(r!==n);return this},addAdjoiningFace:function(e,n){var l=c.create(e,n.tail(),n.head());return this.faces.push(l),l.getEdge(-1).setTwin(n.twin),l.getEdge(0)},addNewFaces:function(e,n){this.newFaces=[];for(var l=null,h=null,r=0;r<n.length;r++){var f=n[r],a=this.addAdjoiningFace(e,f);l===null?l=a:a.next.setTwin(h),this.newFaces.push(a.face),h=a}return l.next.setTwin(h),this},addVertexToHull:function(e){var n=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,n),this.addNewFaces(e,n),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var e;for(this.computeInitialHull();(e=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}});function c(){this.normal=new E,this.midpoint=new E,this.area=0,this.constant=0,this.outside=null,this.mark=o,this.edge=null}Object.assign(c,{create:function(e,n,l){var h=new c,r=new u(e,h),f=new u(n,h),a=new u(l,h);return r.next=a.prev=f,f.next=r.prev=a,a.next=f.prev=r,h.edge=r,h.compute()}}),Object.assign(c.prototype,{getEdge:function(e){for(var n=this.edge;e>0;)n=n.next,e--;for(;e<0;)n=n.prev,e++;return n},compute:function(){var e;return function(){e===void 0&&(e=new ue);var l=this.edge.tail(),h=this.edge.head(),r=this.edge.next.head();return e.set(l.point,h.point,r.point),e.getNormal(this.normal),e.getMidpoint(this.midpoint),this.area=e.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint:function(e){return this.normal.dot(e)-this.constant}});function u(e,n){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=n}Object.assign(u.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var e=this.head(),n=this.tail();return n!==null?n.point.distanceTo(e.point):-1},lengthSquared:function(){var e=this.head(),n=this.tail();return n!==null?n.point.distanceToSquared(e.point):-1},setTwin:function(e){return this.twin=e,e.twin=this,this}});function m(e){this.point=e,this.prev=null,this.next=null,this.face=null}function w(){this.head=null,this.tail=null}return Object.assign(w.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(e,n){return n.prev=e.prev,n.next=e,n.prev===null?this.head=n:n.prev.next=n,e.prev=n,this},insertAfter:function(e,n){return n.prev=e,n.next=e.next,n.next===null?this.tail=n:n.next.prev=n,e.next=n,this},append:function(e){return this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this},appendChain:function(e){for(this.head===null?this.head=e:this.tail.next=e,e.prev=this.tail;e.next!==null;)e=e.next;return this.tail=e,this},remove:function(e){return e.prev===null?this.head=e.next:e.prev.next=e.next,e.next===null?this.tail=e.prev:e.next.prev=e.prev,this},removeSubList:function(e,n){return e.prev===null?this.head=n.next:e.prev.next=n.next,n.next===null?this.tail=e.prev:n.next.prev=e.prev,this},isEmpty:function(){return this.head===null}}),i}();const We=new E,k=new E,Xe=new ye;function I(o){const t=qe(o);if(t.length===0)return null;if(t.length===1)return W(t[0]);let s;const i=[];for(;s=t.pop();)i.push(Ye(W(s)));return $e(i)}function W(o){let t=o.geometry;return t.toBufferGeometry?t=t.toBufferGeometry():t=t.clone(),o.updateMatrixWorld(),o.matrixWorld.decompose(We,Xe,k),t.scale(k.x,k.y,k.z),t}function $e(o){let t=0;for(let c=0;c<o.length;c++){const u=o[c].attributes.position;u&&u.itemSize===3&&(t+=u.count)}const s=new Float32Array(t*3);let i=0;for(let c=0;c<o.length;c++){const u=o[c].attributes.position;if(u&&u.itemSize===3)for(let m=0;m<u.count;m++)s[i++]=u.getX(m),s[i++]=u.getY(m),s[i++]=u.getZ(m)}return new V().setAttribute("position",new J(s,3))}function ee(o){const t=o.attributes.position,s=new Float32Array(t.count*3);for(let i=0;i<t.count;i++)s[i*3]=t.getX(i),s[i*3+1]=t.getY(i),s[i*3+2]=t.getZ(i);return s}function qe(o){const t=[];return o.traverse(function(s){s.isMesh&&t.push(s)}),t}function H(o,t){switch(t){case"x":return o.x;case"y":return o.y;case"z":return o.z}throw new Error(`Unexpected component ${t}`)}function Ye(o,t=1e-4){t=Math.max(t,Number.EPSILON);const s={},i=o.getIndex(),c=o.getAttribute("position"),u=i?i.count:c.count;let m=0;const w=[],e=[],n=Math.log10(1/t),l=Math.pow(10,n);for(let f=0;f<u;f++){const a=i?i.getX(f):f;let p="";p+=`${~~(c.getX(a)*l)},`,p+=`${~~(c.getY(a)*l)},`,p+=`${~~(c.getZ(a)*l)},`,p in s?w.push(s[p]):(e.push(c.getX(a)),e.push(c.getY(a)),e.push(c.getZ(a)),s[p]=m,w.push(m),m++)}const h=new J(new Float32Array(e),c.itemSize,c.normalized),r=new V;return r.setAttribute("position",h),r.setIndex(w),r}const X=Math.PI/2;var v;(function(o){o.BOX="Box",o.CYLINDER="Cylinder",o.SPHERE="Sphere",o.HULL="ConvexPolyhedron",o.MESH="Trimesh"})(v||(v={}));const Ue=function(t,s={}){let i;if(s.type===v.BOX)return q(t);if(s.type===v.CYLINDER)return st(t,s);if(s.type===v.SPHERE)return rt(t,s);if(s.type===v.HULL)return tt(t);if(s.type===v.MESH)return i=I(t),i?at(i):null;if(s.type)throw new Error(`[CANNON.getShapeParameters] Invalid type "${s.type}".`);if(i=I(t),!i)return null;switch(i.type){case"BoxGeometry":case"BoxBufferGeometry":return $(i);case"CylinderGeometry":case"CylinderBufferGeometry":return nt(i);case"PlaneGeometry":case"PlaneBufferGeometry":return it(i);case"SphereGeometry":case"SphereBufferGeometry":return ot(i);case"TubeGeometry":case"BufferGeometry":return q(t);default:return console.warn('Unrecognized geometry: "%s". Using bounding box as shape.',i.type),$(i)}},De=function(t,s={}){const i=Ue(t,s);if(!i)return null;const{type:c,params:u,offset:m,orientation:w}=i;let e;return c===v.BOX?e=Ze(u):c===v.CYLINDER?e=Qe(u):c===v.SPHERE?e=Ke(u):c===v.HULL?e=Je(u):e=et(u),{shape:e,offset:m,orientation:w}};function Ze(o){const{x:t,y:s,z:i}=o;return new S(new x(t,s,i))}function Qe(o){const{radiusTop:t,radiusBottom:s,height:i,segments:c}=o,u=new pe(t,s,i,c);return u.radiusTop=s,u.radiusBottom=s,u.height=i,u.numSegments=c,u}function Ke(o){return new D(o.radius)}function Je(o){const{faces:t,vertices:s}=o,i=[];for(let u=0;u<s.length;u+=3)i.push(new x(s[u],s[u+1],s[u+2]));return new fe({faces:t,vertices:i})}function et(o){const{vertices:t,indices:s}=o;return new me(t,s)}function $(o){if(!ee(o).length)return null;o.computeBoundingBox();const s=o.boundingBox;return{type:v.BOX,params:{x:(s.max.x-s.min.x)/2,y:(s.max.y-s.min.y)/2,z:(s.max.z-s.min.z)/2}}}function q(o){const t=o.clone();t.quaternion.set(0,0,0,1),t.updateMatrixWorld();const s=new Z().setFromObject(t);if(!isFinite(s.min.lengthSq()))return null;const i=s.translate(t.position.negate()).getCenter(new E);return{type:v.BOX,params:{x:(s.max.x-s.min.x)/2,y:(s.max.y-s.min.y)/2,z:(s.max.z-s.min.z)/2},offset:i.lengthSq()?new x(i.x,i.y,i.z):void 0}}function tt(o){const t=I(o);if(!t)return null;const s=1e-4;for(let n=0;n<t.attributes.position.count;n++)t.attributes.position.setXYZ(n,t.attributes.position.getX(n)+(Math.random()-.5)*s,t.attributes.position.getY(n)+(Math.random()-.5)*s,t.attributes.position.getZ(n)+(Math.random()-.5)*s);const c=new Ve().setFromObject(new Q(t)).faces,u=[],m=[];let w=0;for(let n=0;n<c.length;n++){const l=c[n],h=[];m.push(h);let r=l.edge;do{const f=r.head().point;u.push(f.x,f.y,f.z),h.push(w),w++,r=r.next}while(r!==l.edge)}const e=new Float32Array(u.length);return e.set(u),{type:v.HULL,params:{vertices:e,faces:m}}}function nt(o){const t=o.parameters;return{type:v.CYLINDER,params:{radiusTop:t.radiusTop,radiusBottom:t.radiusBottom,height:t.height,segments:t.radialSegments},orientation:new K().setFromEuler(ge.degToRad(-90),0,0,"XYZ").normalize()}}function st(o,t){const s=["x","y","z"],i=t.cylinderAxis||"y",c=s.splice(s.indexOf(i),1)&&s,u=new Z().setFromObject(o);if(!isFinite(u.min.lengthSq()))return null;const m=u.max[i]-u.min[i],w=.5*Math.max(H(u.max,c[0])-H(u.min,c[0]),H(u.max,c[1])-H(u.min,c[1])),e=i==="y"?X:0,n=i==="z"?X:0;return{type:v.CYLINDER,params:{radiusTop:w,radiusBottom:w,height:m,segments:12},orientation:new K().setFromEuler(e,n,0,"XYZ").normalize()}}function it(o){o.computeBoundingBox();const t=o.boundingBox;return{type:v.BOX,params:{x:(t.max.x-t.min.x)/2||.1,y:(t.max.y-t.min.y)/2||.1,z:(t.max.z-t.min.z)/2||.1}}}function ot(o){return{type:v.SPHERE,params:{radius:o.parameters.radius}}}function rt(o,t){if(t.sphereRadius)return{type:v.SPHERE,params:{radius:t.sphereRadius}};const s=I(o);return s?(s.computeBoundingSphere(),{type:v.SPHERE,params:{radius:s.boundingSphere.radius}}):null}function at(o){const t=ee(o);if(!t.length)return null;const s=new Uint32Array(t.length);for(let i=0;i<t.length;i++)s[i]=i;return{type:v.MESH,params:{vertices:t,indices:s}}}class lt{constructor(){this.init()}init(){this.isNpc=!1,this.timeStep=1/60,this.lastCallTime=performance.now(),this.app=document.getElementById("classWrapper"),this.dialoge=document.getElementById("dialoge"),this.instructions=document.getElementById("instructions"),this.blocker=document.getElementById("blocker"),this.crossHair=document.getElementById("cross"),this.canvas=document.getElementsByTagName("canvas"),this.exitBut=document.getElementById("button"),this.progressContainer=document.getElementById("container"),this.progress=document.getElementById("progress"),this.label=document.getElementById("label"),this.pos=document.getElementById("pos"),this.crossHair.style.display="none",this.dialoge.style.display="none",this.initThree(),this.Manger(),this.loadModels(),this.initCannon(),this.initPointerLock(),this.addWall(),this.setVRContorl(),this.animate()}initThree(){this.camera=new we(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,0,0),this.scene=new xe;let t="./src/assets/";this.scene.background=new ve().setPath(t).load(["px.jpg","nx.jpg","py.jpg","ny.jpg","pz.jpg","nz.jpg"]),this.renderer=new Be({antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.app.appendChild(this.renderer.domElement),this.stats=new je,this.app.appendChild(this.stats.dom);let s=new be(14745599,.8);this.scene.add(s),s=new Se(16777215,1),s.castShadow=!0,s.position.set(0,10,0),this.scene.add(s),this.material=new Ee({transparent:!0,opacity:0});const i=new Pe(100,100,1,1);i.rotateX(-Math.PI/2);const c=new Q(i,this.material);c.receiveShadow=!0,c.name="floor",this.scene.add(c),window.addEventListener("resize",this.onWindowResize(this))}onWindowResize(t){t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix(),t.renderer.setSize(window.innerWidth,window.innerHeight)}initCannon(){this.ray=new Ce(new E,new E(0,0,-1),0,10),this.world=new Me,this.world.defaultContactMaterial.contactEquationStiffness=1e9,this.world.defaultContactMaterial.contactEquationRelaxation=4;const t=new Te;t.iterations=7,t.tolerance=.1,this.world.solver=new _e(t),this.world.gravity.set(0,-50,0),this.physicsMaterial=new Le("physics");const s=new Fe(this.physicsMaterial,this.physicsMaterial,{friction:100,restitution:0});this.world.addContactMaterial(s),this.sphereShape=new D(1.5),this.sphereBody=new b({mass:5,material:this.physicsMaterial}),this.sphereBody.addShape(this.sphereShape),this.sphereBody.position.set(3.7,2,1.5),this.sphereBody.linearDamping=.9,this.world.addBody(this.sphereBody);const i=new ze,c=new b({mass:0,material:this.physicsMaterial});c.addShape(i),c.quaternion.setFromEuler(-Math.PI/2,0,0),console.log(c.position),this.world.addBody(c)}initPointerLock(){this.controls=new ke(this.camera,this.sphereBody),this.scene.add(this.controls.getObject()),this.position=this.controls.getObject().position,this.instructions.addEventListener("click",()=>{this.controls.lock()}),this.controls.addEventListener("lock",()=>{this.controls.enabled=!0,this.instructions.style.display="none",this.blocker.style.display="none",this.crossHair.style.display=null}),this.controls.addEventListener("unlock",()=>{this.isNpc||(this.controls.enabled=!1,this.instructions.style.display=null,this.blocker.style.display=null),this.crossHair.style.display="none"})}loadModels(){this.npc=[];let t="./src/model/";this.modelLoader(t+"women/",{x:1,y:1,z:1},{x:1.9,y:0,z:-3.2},{},!0),this.modelLoader(t+"store/",{x:1,y:1,z:1},{x:0,y:0,z:0},{},!1)}setVRContorl(){console.log("vr"),this.blocker.appendChild(He.createButton(this.renderer)),this.renderer.xr.enabled=!0,this.renderer.xr.addEventListener("sessionstart",()=>{this.controls.lock(),this.camera.position.y=-50},!1)}Manger(){this.loadingManger=new Ie,this.loadingManger.onStart=()=>{this.instructions.style.display="none",this.blocker.style.display="none"},this.loadingManger.onProgress=(t,s,i)=>{this.progress.value=s/i*100,this.label.innerText=(s/i*100).toFixed(2)+"%  loading:"+t},this.loadingManger.onLoad=()=>{this.progressContainer.style.display="none",this.instructions.style.display=null,this.blocker.style.display=null}}modelLoader(t,s,i,c,u){this.loader=new Ae(this.loadingManger).setPath(t),this.loader.load("scene.glb",m=>{if(m.scene.scale.set(s.x,s.y,s.z),m.scene.position.set(i.x,i.y,i.z),this.scene.add(m.scene),u){let w=De(m.scene,{type:v.BOX}),e=new b;e.position=m.scene.position,e.addShape(w.shape,w.offset,w.orientation),this.npc.push(m.scene),this.world.addBody(e)}},m=>{},m=>{console.log(m)})}addWall(){let t=this;function s(){const a=new x(3.5,3,1e-4),p=new x(8.8,1.4,11),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function i(){const a=new x(1e-4,3,10),p=new x(12.8,1.5,0),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function c(){const a=new x(1e-4,3,6),p=new x(5.2,1.4,7),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function u(){const a=new x(3.5,3,1e-4),p=new x(1,1.4,3),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function m(){const a=new x(1e-4,3,1.4),p=new x(5.2,1.4,-4),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function w(){const a=new x(5,3,1e-4),p=new x(-1,1.4,-5),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function e(){const a=new x(3.5,3,1e-4),p=new x(8.8,1.4,-10),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function n(){const a=new x(1e-4,3,6),p=new x(-7.2,1.4,-2),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function l(){const a=new x(1e-4,3,10),p=new x(12.8,1.5,0),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function h(){const a=new x(1e-4,3,3),p=new x(4,1.5,-10),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function r(){const a=new x(15,1e-4,15),p=new x(0,4,0),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}function f(){const a=new x(3.5,3,1e-4),p=new x(-3,1.4,4),g=new S(a),d=new b({mass:0});d.addShape(g),d.position=p,t.world.addBody(d)}s(),i(),c(),u(),m(),w(),e(),n(),l(),h(),r(),f()}getShootDirection(){const t=new E(0,0,1);return t.unproject(this.camera),new Re(this.sphereBody.position,t.sub(this.sphereBody.position).normalize()).direction}render(){this.renderer.render(this.scene,this.camera)}animate(){this.renderer.setAnimationLoop(this.animate.bind(this));let t=this.canvas.item(0);if(this.controls.enabled==!0){let w=function(){console.log("stop"),i.zoom=10,s.disconnect(),s.unlock(),c.style.display=null,m.style.display="none",u.style.display="none",document.removeEventListener("click",w)},e=function(){console.log("remove"),document.removeEventListener("click",w),s.connect(),s.lock(),c.style.display="none",u.style.display=null,t.focus()};this.pos.innerText=`(x:${this.controls.getObject().position.x.toFixed(2)},z:${this.controls.getObject().position.z.toFixed(2)})`,this.ray.ray.origin.copy(this.controls.getObject().position),this.ray.ray.direction.copy(this.getShootDirection()),this.intersections=this.ray.intersectObjects(this.npc,!0);let s=this.controls,i=this.camera,c=this.dialoge,u=this.crossHair,m=this.blocker;this.intersections.length>0&&this.intersections[0].distance<2&&!this.isNpc&&(this.isAddEvent=!0,this.isNpc=!0,console.log("inn"),document.addEventListener("click",w,!1),this.exitBut.addEventListener("click",()=>{console.log("exit"),e(this.isNpc),this.isNpc=!1,this.isAddEvent=!0},!0),setTimeout(()=>{document.removeEventListener("click",w),this.isNpc=!1,this.isAddEvent=!0},200));const n=performance.now()/1e3,l=n-this.lastCallTime;this.lastCallTime=n,this.world.step(this.timeStep,l),this.controls.update(l)}this.stats.update(),this.render()}getObj(){return this}}const ct={setup(){let o=U({url:void 0,input:void 0,output:void 0});function t(){Ne(o.input).then(i=>{o.url="data:audio/mpeg;base64,"+i.data.outputAudio,o.output=i.data.queryResult.fulfillmentText})}function s(){o.url=void 0,o.output=void 0}return{src:o,test:t,endPlay:s}}},dt=o=>(re("data-v-5f50718f"),o=o(),ae(),o),ht={id:"dialoge"},ut=["src"],pt={class:"out"},ft=dt(()=>F("div",{id:"button"}," exit ",-1));function mt(o,t,s,i,c,u){return j(),N("div",ht,[te(F("input",{type:"text",placeholder:"type in question","onUpdate:modelValue":t[0]||(t[0]=m=>i.src.input=m),onKeyup:t[1]||(t[1]=se(m=>i.test(),["enter"]))},null,544),[[ne,i.src.input]]),i.src.url?(j(),N("audio",{key:0,autobuffer:"autobuffer",autoplay:"autoplay",onEnded:t[2]||(t[2]=m=>i.endPlay())},[F("source",{src:i.src.url},null,8,ut)],32)):ie("",!0),F("div",pt,oe(i.src.output),1),ft])}const yt=Y(ct,[["render",mt],["__scopeId","data-v-5f50718f"]]);const gt={components:{cross:Ge,dialoge:yt,progressBar:Oe},setup(){let o;return le(()=>{o=U(new lt)}),ce(()=>{console.log()}),{obj:o}}},wt={id:"classWrapper"},xt=F("div",{id:"blocker"},[F("div",{id:"instructions"},[F("p",null," click me to start ")])],-1);function vt(o,t,s,i,c,u){const m=G("cross"),w=G("dialoge"),e=G("progressBar");return j(),N("div",wt,[O(m),O(w),O(e),xt])}const Pt=Y(gt,[["render",vt]]);export{Pt as default};
